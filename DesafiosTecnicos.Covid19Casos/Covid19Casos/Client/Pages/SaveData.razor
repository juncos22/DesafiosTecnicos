@page "/nuevocaso"

@inject HttpClient Http

<h1 class="text-center">Nuevo Caso de Covid19</h1>

<div class="row m-3">
    <div class="col-md-6 m-auto">
        <h4>Agregar un nuevo caso</h4>
        <EditForm Model="@Model" OnValidSubmit="@GuardarCaso">
            <div class="form-group">
                <label>Fecha del Caso</label>
                <InputDate class="form-control" @bind-Value="Model.Fecha" />
            </div>
            <div class="form-group">
                <label>Edad</label>
                <InputNumber class="form-control" @bind-Value="Model.Edad" />
            </div>
            <div class="form-group">
                <label>Genero</label>
                <InputSelect class="form-control" @bind-Value="@Model.Genero">
                    <option value="M">Masculino</option>
                    <option value="F">Femenino</option>
                </InputSelect>
            </div>
            <div class="form-group">
                <label>Provincia</label>
                <InputText class="form-control" @bind-Value="Model.Provincia" />
            </div>
            <button type="submit" class="btn btn-primary btn-block">Registrar Caso</button>
        </EditForm>
    </div>
</div>

@code {
    //public CasoResponse Response = new CasoResponse();
    public CasoViewModel Model = new CasoViewModel();

    async Task GuardarCaso()
    {
        await Http.PostAsJsonAsync<CasoViewModel>("covid/update", Model);
        LimpiarCampos();
    }

    void LimpiarCampos()
    {
        Model.Fecha = DateTime.Now;
        Model.Edad = 0;
        Model.Genero = "M";
        Model.Provincia = "";
    }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        Model.Fecha = DateTime.Now;
        Model.Genero = "M";
    }

}
